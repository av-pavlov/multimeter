# Multimeter

Multimeter - это система автоматизированной проверки заданий по программированию. Исходно предназначалась для проведения олимпиад. В настоящее время находится в процессе адаптации к проведению лабораторных работ для студентов по дисциплинам, включающим программирование.

Состоит их двух частей: 

* *web-сервера*, который принимает от пользователей исходный код решений,
* *арбитра*, который проверяет решения на тестах. 

Исходно система работает с единым набором задач, настроек и пользователей для одного соревнования, который хранится в *рабочей папке*. Настройки соревнования, такие как время начала и окончания, возможность видеть результаты других пользователей и т.п., хранятся в файле `settings.json`, список пользователей с паролями в файле `users.json`, настройки для компиляции и запуска решений на различных языках программирования в файле `languages.json`. 

Задачи хранятся в подпапках рабочей папки, и состоят из тестов и эталонных ответов, а также проверяющей программы (чекера), написанной с использованием библиотеки [testlib](https://github.com/MikeMirzayanov/testlib). Название задачи, предельное время исполнения и объем памяти, а также схема оценивания подзадач хранятся в файле `task.json` в папке каждой задачи.

Сервер и арбитр общаются через файловую систему. 

Сервер построен на микрофреймворке Flask с использованием шаблонов Jinja2 и системы локализации babel. Сервер принимает решения от пользвателей в виде файлов исходного кода, переименовывает их так, чтобы название содержало информацию о задаче, пользователе, языке программирования  и номере попытки, и складывает в папку `.queue` в рабочей папке. 

Арбитр забирает решения, компилирует их в соответствии с настройками в `languages.json`. Если этап компиляции завершается с ошибкой, попытке выносится единый вердикт `CE` - compile error, и дальнейшее тестирование не производится. В противном случае, арбитр запускает решение способом, указанным в `languages.json` (например, для интерпретируемых языков будет запущен интепретатор, для ВМ Java будут указаны дополнительные ключи управления памятью) и скармливает им один за другим тесты, записывая ответ программы. Если программа завершается аварийно, для данного теста выносится вердикт `RE` (runtime eror). Если программа превысила лимит времени или памяти, выносится вердикт, соответвенно `TL` (time limit exceeded) или `ML` (memory limit exceeded). В противном случае для каждого теста запускается чекер, который сравнивает ответ с эталонным, и выносит один из вердиктов `OK`, `WA` (wrong answer) или `PE` (presentation error, ошибка формата, например, строка вместо числа). Арбитр записывает протокол тестирования в виде json файла в папку .results. Арбитр не занимается подсчетом баллов.

Сервер парсит результаты тестирования, применяя схему оценки, указанную в `task.json`, и показывает результаты попытки участнику. Сервер также показывает общую таблицу соревнования администратору, а если разрешено настройками, и участникам. 
